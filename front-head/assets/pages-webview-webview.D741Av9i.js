import{r as e,o as l,Q as a,d as s,w as t,a5 as n,i as o,e as i,t as u,f as c,m as d,l as r,v,h as f,a6 as p,R as w,c as _,a7 as m,s as y,a8 as b}from"./index-DWDfi1U8.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";const h=g({__name:"webview",setup(g){const h=e(""),k=e("å†…åµŒé¡µé¢"),x=e(!1),L=e(!0),R=e(!1),C=e(!1),P=e({});function T(){a().length>1?w():_({url:"/pages/profile/profile"})}function U(){L.value=!1,console.log("é¡µé¢åŠ è½½å®Œæˆ")}function F(){h.value&&(x.value?window.open(h.value,"_blank"):(C.value=!0,m({url:h.value,success(e){e&&e.tempFilePath?b({filePath:e.tempFilePath,fileType:"pdf",success(){console.log("æ‰“å¼€æ–‡æ¡£æˆåŠŸ")},fail(e){console.error("æ‰“å¼€æ–‡æ¡£å¤±è´¥",e),y({title:"æ‰“å¼€å¤±è´¥ï¼Œè¯·ä¸‹è½½åæŸ¥çœ‹",icon:"none"})},complete(){C.value=!1}}):(C.value=!1,y({title:"ä¸‹è½½å¤±è´¥",icon:"none"}))},fail(e){C.value=!1,console.error("ä¸‹è½½å¤±è´¥",e),y({title:"ä¸‹è½½å¤±è´¥",icon:"none"})}})))}return l(()=>{var e;x.value=!0;const l=a(),s=l[l.length-1],t=(null==(e=s.$page)?void 0:e.options)||s.options||{};console.log("webview é¡µé¢å‚æ•°:",t);const o=t.url;if(o)try{const e=decodeURIComponent(o);h.value=e;const l=e.toLowerCase();(l.endsWith(".pdf")||l.includes(".pdf?")||l.includes("file.pdf"))&&(R.value=!0),e.includes("/files")?k.value="æ–‡ä»¶ç®¡ç†":e.includes("/2048")?k.value="2048 æ¸¸æˆ":(e.includes("/ssfzx")||e.includes("/blinkfy")||e.includes("/flynnxu")||e.includes("/m0_55046343"))&&(k.value="å…³äºå¼€å‘è€…"),console.log("è§£æåçš„ URL:",e,"isPdf=",R.value)}catch(u){h.value=o,console.error("URL è§£ç å¤±è´¥:",u)}else console.warn("æœªè·å–åˆ° url å‚æ•°");function i(e=0){if(x.value)return void(P.value={});try{const l=a(),s=l[l.length-1];n().in(s).select(".webview-header").boundingClientRect(l=>{const a=l&&l.height?l.height:0;a>0?P.value={top:`${a}px`,bottom:"0px"}:e<6?setTimeout(()=>i(e+1),100):P.value={top:"88px",bottom:"0px"}}).exec()}catch(l){e<3&&setTimeout(()=>i(e+1),120)}}i(),"undefined"!=typeof window&&(void 0!==window.plus?i():document.addEventListener("plusready",()=>i())),setTimeout(()=>i(),300),setTimeout(()=>i(),800);try{window.addEventListener("resize",()=>i())}catch(u){}}),(e,l)=>{const a=d,n=o,w=p;return i(),s(n,{class:"webview-page"},{default:t(()=>[x.value?u("",!0):(i(),s(n,{key:0,class:"webview-header"},{default:t(()=>[c(n,{class:"header-content"},{default:t(()=>[c(n,{class:"back-btn",onClick:T},{default:t(()=>[c(a,{class:"back-icon"},{default:t(()=>[r("â†")]),_:1}),c(a,{class:"back-text"},{default:t(()=>[r("è¿”å›")]),_:1})]),_:1}),R.value?(i(),s(n,{key:0,class:"preview-btn",onClick:F},{default:t(()=>[C.value?(i(),s(a,{key:1},{default:t(()=>[r("ä¸‹è½½ä¸­...")]),_:1})):(i(),s(a,{key:0},{default:t(()=>[r("é¢„è§ˆ PDF")]),_:1}))]),_:1})):u("",!0),c(n,{class:"title-section"},{default:t(()=>[c(a,{class:"webview-title"},{default:t(()=>[r(v(k.value),1)]),_:1}),c(n,{class:"title-indicator"})]),_:1})]),_:1})]),_:1})),c(n,{class:"webview-content"},{default:t(()=>[x.value&&h.value?(i(),f("iframe",{key:0,src:h.value,class:"webview-iframe",onLoad:U},null,40,["src"])):!x.value&&h.value?(i(),s(w,{key:1,src:h.value,class:"webview-container","webview-styles":P.value,onLoad:U},null,8,["src","webview-styles"])):(i(),s(n,{key:2,class:"webview-empty"},{default:t(()=>[c(n,{class:"empty-icon"},{default:t(()=>[h.value?(i(),s(n,{key:1,class:"loading-spinner"},{default:t(()=>[c(n,{class:"spinner-ring"}),c(n,{class:"spinner-ring"}),c(n,{class:"spinner-ring"})]),_:1})):(i(),s(a,{key:0},{default:t(()=>[r("ğŸ“­")]),_:1}))]),_:1}),c(a,{class:"empty-title"},{default:t(()=>[r(v(h.value?"æ­£åœ¨åŠ è½½...":"æ— å¯ç”¨åœ°å€"),1)]),_:1}),h.value?(i(),s(a,{key:0,class:"empty-subtitle"},{default:t(()=>[r("è¯·ç¨å€™")]),_:1})):u("",!0),h.value?u("",!0):(i(),s(a,{key:1,class:"debug-info"},{default:t(()=>[r("æœªè·å–åˆ°æœ‰æ•ˆ URL")]),_:1}))]),_:1}))]),_:1})]),_:1})}}},[["__scopeId","data-v-d5800830"]]);export{h as default};
