import{r as a,o as t,d as o,e,w as n,f as r,t as l,i as s,x as d,I as i,u,k as c,m,l as h,v as f}from"./index-DWDfi1U8.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";const M=p({__name:"CaptchaBox",props:{modelValue:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(p,{expose:M,emit:x}){const $=p,v=x,g=a(""),F=a(""),w=a(""),_=a(!1);function y(){const a=function(a=4){const t="abcdefghjkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789";let o="";for(let e=0;e<a;e++)o+=t.charAt(Math.floor(55*Math.random()));return o}(4);F.value=a;const t=function(a,t=120,o=40){const e=a.length,n=t/(e+1);let r=`<svg xmlns="http://www.w3.org/2000/svg" width="${t}" height="${o}">`;r+='<rect width="100%" height="100%" fill="#f7f9ff" />';for(let l=0;l<10;l++){const a=Math.random()*t,e=Math.random()*o,n=Math.random()*t,l=Math.random()*o,s=`rgba(${50+Math.floor(180*Math.random())},${50+Math.floor(180*Math.random())},${50+Math.floor(180*Math.random())},0.6)`;r+=`<line x1="${a.toFixed(1)}" y1="${e.toFixed(1)}" x2="${n.toFixed(1)}" y2="${l.toFixed(1)}" stroke="${s}" stroke-width="1.5"/>`}for(let l=0;l<50;l++){const a=Math.random()*t,e=Math.random()*o,n=1.5*Math.random()+1,l=`rgba(${100+Math.floor(120*Math.random())},${100+Math.floor(120*Math.random())},${100+Math.floor(120*Math.random())},0.7)`;r+=`<circle cx="${a.toFixed(1)}" cy="${e.toFixed(1)}" r="${n.toFixed(2)}" fill="${l}" />`}for(let l=0;l<e;l++){const t=a[l],e=(l+.8)*n,s=o/2+(6*Math.random()-2),d=(30*Math.random()-15).toFixed(1),i=Math.floor(o*(.55+.15*Math.random())),u=`rgb(${30+Math.floor(160*Math.random())},${30+Math.floor(160*Math.random())},${30+Math.floor(160*Math.random())})`;r+=`<text x="${e.toFixed(1)}" y="${s.toFixed(1)}" font-family="Arial" font-weight="700" font-size="${i}" fill="${u}" transform="rotate(${d}, ${e.toFixed(1)}, ${s.toFixed(1)})" text-anchor="middle">${t}</text>`}return r+="</svg>",r}(a,140,48);g.value=function(a){try{return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a)))}catch(t){return"data:image/svg+xml;utf8,"+encodeURIComponent(a)}}(t),w.value="",v("update:modelValue","")}function C(a){var t,o;const e=(null==(t=null==a?void 0:a.detail)?void 0:t.value)??(null==(o=null==a?void 0:a.target)?void 0:o.value)??"";v("update:modelValue",e)}return t(()=>{y()}),M({validate:function(){const a=($.modelValue||"").trim();return!!a&&a.toLowerCase()===(F.value||"").toLowerCase()},refresh:y}),(a,t)=>{const M=i,x=s,$=c,v=m;return e(),o(x,null,{default:n(()=>[r(x,{class:"captcha-container"},{default:n(()=>[r(x,{class:d(["captcha-input-wrapper input-wrapper-simple",{focused:_.value}])},{default:n(()=>[r(M,{value:p.modelValue,onInput:C,onFocus:t[0]||(t[0]=a=>_.value=!0),onBlur:t[1]||(t[1]=a=>_.value=!1),placeholder:"请输入验证码",maxlength:"6",class:"captcha-input form-input-simple",onConfirm:t[2]||(t[2]=t=>a.$emit("confirm")),onKeyup:t[3]||(t[3]=u(t=>a.$emit("confirm"),["enter"]))},null,8,["value"]),r(x,{class:"input-border"})]),_:1},8,["class"]),r(x,{class:"captcha-image-container",onClick:y},{default:n(()=>[r($,{src:g.value,class:"captcha-image",mode:"aspectFill"},null,8,["src"])]),_:1})]),_:1}),w.value?(e(),o(v,{key:0,class:"hint"},{default:n(()=>[h(f(w.value),1)]),_:1})):l("",!0)]),_:1})}}},[["__scopeId","data-v-7e26df12"]]);export{M as C};
