import{d as t,w as e,z as s,s as a,C as l,V as o,i,e as n,f as c,m as u,l as r,x as d,v as p,t as f,y as m,I as _}from"./index-DWDfi1U8.js";import{i as h}from"./map.D58OIJrJ.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.D9Dqt54M.js";const g=y({data:()=>({testKeyword:"餐厅",locationResult:null,searchResult:null}),computed:{isApiKeyConfigured:()=>h()},methods:{testLocation(){const t="mp-alipay"===l().uniPlatform,e={success:t=>{let e=t.latitude,s=t.longitude;"string"==typeof e&&(e=parseFloat(e)),"string"==typeof s&&(s=parseFloat(s)),this.locationResult={latitude:e,longitude:s},a({title:"位置获取成功",icon:"success"})},fail:t=>{if(console.log("获取位置失败:",t),t.errMsg&&t.errMsg.includes("暂不支持 type")){console.log("支付宝小程序不支持type参数，重试不传type");const t={...e};return delete t.type,void o(t)}a({title:"位置获取失败",icon:"none"})}};t||(e.type="gcj02"),o(e)},testSearch(){if(!this.locationResult||!this.locationResult.latitude||!this.locationResult.longitude)return void a({title:"位置未初始化",icon:"none"});const t=document.createElement("script");t.src=`https://apis.map.qq.com/ws/place/v1/search?keyword=${this.testKeyword}&boundary=nearby(${this.locationResult.latitude},${this.locationResult.longitude},5000)&key=RZPBZ-AXLY3-ENO3Q-O3AZU-JGX4Q-KTFZU&page_size=20&page_index=1&callback=handleResponse`,document.body.appendChild(t),window.handleResponse=t=>{0===t.status?(this.searchResult={count:t.data?t.data.length:0},a({title:"搜索测试成功",icon:"success"})):a({title:"搜索测试失败",icon:"none"})}},goToMap(){s({url:"/pages/map/map"})}},server:{proxy:{"/api/map":{target:"https://apis.map.qq.com",changeOrigin:!0,rewrite:t=>t.replace(/^\/api\/map/,"")}}}},[["render",function(s,a,l,o,h,y){const g=u,R=i,k=m,C=_;return n(),t(R,{class:"test-container"},{default:e(()=>[c(R,{class:"test-header"},{default:e(()=>[c(g,{class:"test-title"},{default:e(()=>[r("地图功能测试")]),_:1})]),_:1}),c(R,{class:"test-section"},{default:e(()=>[c(g,{class:"section-title"},{default:e(()=>[r("API密钥状态")]),_:1}),c(R,{class:"status-item"},{default:e(()=>[c(g,{class:"status-label"},{default:e(()=>[r("API密钥:")]),_:1}),c(g,{class:d(["status-value",{error:!y.isApiKeyConfigured}])},{default:e(()=>[r(p(y.isApiKeyConfigured?"已配置":"未配置"),1)]),_:1},8,["class"])]),_:1})]),_:1}),c(R,{class:"test-section"},{default:e(()=>[c(g,{class:"section-title"},{default:e(()=>[r("位置权限测试")]),_:1}),c(k,{class:"test-btn",onClick:y.testLocation},{default:e(()=>[r("测试获取位置")]),_:1},8,["onClick"]),h.locationResult?(n(),t(R,{key:0,class:"test-result"},{default:e(()=>[c(g,null,{default:e(()=>[r("纬度: "+p(h.locationResult.latitude),1)]),_:1}),c(g,null,{default:e(()=>[r("经度: "+p(h.locationResult.longitude),1)]),_:1})]),_:1})):f("",!0)]),_:1}),c(R,{class:"test-section"},{default:e(()=>[c(g,{class:"section-title"},{default:e(()=>[r("搜索功能测试")]),_:1}),c(C,{class:"test-input",modelValue:h.testKeyword,"onUpdate:modelValue":a[0]||(a[0]=t=>h.testKeyword=t),placeholder:"输入搜索关键词"},null,8,["modelValue"]),c(k,{class:"test-btn",onClick:y.testSearch},{default:e(()=>[r("测试搜索")]),_:1},8,["onClick"]),h.searchResult?(n(),t(R,{key:0,class:"test-result"},{default:e(()=>[c(g,null,{default:e(()=>[r("搜索结果数量: "+p(h.searchResult.count),1)]),_:1}),h.searchResult.error?(n(),t(g,{key:0},{default:e(()=>[r("错误: "+p(h.searchResult.error),1)]),_:1})):f("",!0)]),_:1})):f("",!0)]),_:1}),c(R,{class:"test-section"},{default:e(()=>[c(k,{class:"test-btn primary",onClick:y.goToMap},{default:e(()=>[r("进入地图页面")]),_:1},8,["onClick"])]),_:1})]),_:1})}],["__scopeId","data-v-3a694d0a"]]);export{g as default};
